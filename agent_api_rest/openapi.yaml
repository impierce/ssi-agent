openapi: 3.1.0
info:
  title: UniCore HTTP API
  description: Full HTTP API reference for the UniCore SSI Agent
  license:
    name: ''
  version: ''
servers:
- url: https://playground.agent-dev.impierce.com
  description: UniCore development server hosted by Impierce Technologies
paths:
  /.well-known/oauth-authorization-server:
    get:
      tags:
      - (.well-known)
      - (public)
      summary: Authorization Server Metadata
      description: Standard OpenID Connect discovery endpoint for authorization metadata.
      operationId: oauth_authorization_server
      responses:
        '200':
          description: Successfully returns the Authorization Server Metadata
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AuthorizationServerMetadata'
  /.well-known/openid-credential-issuer:
    get:
      tags:
      - (.well-known)
      - (public)
      summary: Credential Issuer Metadata
      description: Standard OpenID Connect discovery endpoint for issuer metadata.
      operationId: openid_credential_issuer
      responses:
        '200':
          description: Successfully returns the Credential Issuer Metadata
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CredentialIssuerMetadata'
  /auth/token:
    post:
      tags:
      - (public)
      summary: Token Endpoint
      description: Standard OAuth 2.0 endpoint that returns an access_token after successful authorization.
      operationId: token
      requestBody:
        description: ''
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/TokenRequest'
        required: true
      responses:
        '200':
          description: Returns an access token.
  /openid4vci/credential:
    post:
      tags:
      - Issuance
      - (public)
      summary: Credential Endpoint
      description: Standard OpenID4VCI endpoint for redeeming a token for a credential.
      operationId: credential
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CredentialRequest'
        required: true
      responses:
        '200':
          description: Successfully returns the credential
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CredentialResponse'
  /openid4vci/offers:
    get:
      tags:
      - Holder
      - (public)
      summary: Credential Offer Endpoint
      description: Standard OpenID4VCI endpoint that allows the issuer to pass information to the wallet.
      operationId: offers
      requestBody:
        description: ''
        content:
          application/json:
            schema: {}
        required: true
      responses:
        '200':
          description: Successfully received offer metadata.
  /redirect:
    post:
      tags:
      - (public)
      summary: Redirect Endpoint
      description: Standard OAuth 2.0 endpoint.
      operationId: redirect
      requestBody:
        description: ''
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/GenericAuthorizationResponse'
        required: true
      responses:
        '200':
          description: ''
  /request/{id}:
    get:
      tags:
      - (public)
      summary: Authorization Request
      description: |-
        Standard OAuth 2.0 endpoint.

        Instead of directly embedding the Authorization Request into a QR-code or deeplink, the `Relying Party` can embed a
        `request_uri` that points to this endpoint from where the Authorization Request Object can be retrieved.
        As described here: https://www.rfc-editor.org/rfc/rfc9101.html#name-passing-a-request-object-by-
      operationId: request
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: ''
  /v0/authorization_requests:
    post:
      tags:
      - Verification
      summary: Create a new Authorization Request
      description: UniCore will ask a holder for certain information based on the Presentation Definition specified.
      operationId: authorization_requests
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthorizationRequestsEndpointRequest'
        required: true
      responses:
        '201':
          description: Authorization Request successfully created.
  /v0/authorization_requests/{id}:
    get:
      tags:
      - Verification
      summary: Get an Authorization Request
      description: Retrieve an existing Authorization Request.
      operationId: get_authorization_requests
      parameters:
      - name: id
        in: path
        description: The ID of the Authorization Request to retrieve.
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Successfully returns an existing Authorization Request.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/GenericAuthorizationRequest'
  /v0/credentials:
    post:
      tags:
      - Issuance
      summary: Create a new credential
      description: Create a new credential for a given subject.
      operationId: credentials
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CredentialsEndpointRequest'
            examples:
              openbadges:
                summary: Open Badges 3.0
                description: s0me descr1pti0n
                externalValue: res/open-badge-request.json
              w3c-vc:
                summary: W3C v1.1
                description: s0me descr1pti0n
                value:
                  offerId: 123
                  credentialConfigurationId: w3c_vc_credential
                  credential:
                    credentialSubject:
                      first_name: Ferris
                      last_name: Rustacean
        required: true
      responses:
        '201':
          description: Successfully created a new credential.
          headers:
            Location:
              schema:
                type: string
              description: URL of the created resource
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CredentialView'
              examples:
                openbadges-3-0:
                  summary: Open Badges 3.0
                  description: An badge following the Open Badges Specification 3.0
                  value:
                    foo: bar
                w3c-vc-1-1:
                  summary: W3C VC Data Model v1.1
                  description: A credential following the W3C Verifiable Credentials Data Model v1.1
                  value:
                    offerId: '0001'
        '400':
          description: Invalid payload.
  /v0/credentials/{id}:
    get:
      tags:
      - Credentials
      summary: Retrieve a credential
      description: Return a credential for a given ID.
      operationId: get_credentials
      parameters:
      - name: id
        in: path
        description: Unique identifier of the Credential
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Credential found
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CredentialView'
  /v0/holder/credentials:
    get:
      tags:
      - Holder
      summary: Get all credentials
      description: Retrieve all credentials that this UniCore instance currently holds.
      operationId: credentials
      responses:
        '200':
          description: Successfully retrieved all credentials.
  /v0/holder/offers:
    get:
      tags:
      - Holder
      summary: Get all offers
      description: Retrieve all pending credential offers.
      operationId: offers
      responses:
        '200':
          description: Successfully retrieved all pending offers.
  /v0/holder/offers/{offer_id}/accept:
    post:
      tags:
      - Holder
      summary: Accept an offer
      description: Accepts a pending credential offer.
      operationId: accept
      parameters:
      - name: offer_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Successfully accepted a pending offer.
  /v0/holder/offers/{offer_id}/reject:
    post:
      tags:
      - Holder
      summary: Reject an offer
      description: Reject a pending credential offer.
      operationId: reject
      parameters:
      - name: offer_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Successfully rejected a pending offer.
  /v0/offers:
    post:
      tags:
      - Issuance
      summary: Create a new credential offer
      description: Create a new offer for one or more credentials.
      operationId: offers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OffersEndpointRequest'
        required: true
      responses:
        '200':
          description: Successfully created a new credential offer. Response value is standard-compliant and can be used by identity wallet.
          content:
            application/x-www-form-urlencoded:
              schema:
                type: string
              example: openid-credential-offer://?credential_offer=%7B%22credential_issuer%22%3A%22https%3A%2F%2Fcredential-issuer.example.com%2F%22%2C%22credentials%22%3A%5B%7B%22format%22%3A%22ldp_vc%22%2C%22credential_definition%22%3A%7B%22%40context%22%3A%5B%22https%3A%2F%2Fwww.w3.org%2F2018%2Fcredentials%2Fv1%22%2C%22https%3A%2F%2Fwww.w3.org%2F2018%2Fcredentials%2Fexamples%2Fv1%22%5D%2C%22type%22%3A%5B%22VerifiableCredential%22%2C%22UniversityDegreeCredential%22%5D%7D%7D%5D%7D
components:
  schemas:
    CredentialsEndpointRequest:
      type: object
      required:
      - offerId
      - credential
      - credentialConfigurationId
      properties:
        credential: {}
        credentialConfigurationId:
          type: string
        isSigned:
          type: boolean
        offerId:
          type: string
tags:
- name: (public)
  description: A collection of endpoints that should be publicly accessible without authentication. They are used to resolve metadata or allow communication with wallets.
- name: (.well-known)
  description: Well-known endpoints provide metadata about the server.
- name: Issuance
  description: Issue credentials to holders that will store them in their wallets.
  externalDocs:
    url: https://docs.impierce.com
    description: Issuance API Documentation
externalDocs:
  url: https://docs.impierce.com
  description: Official Documentation
